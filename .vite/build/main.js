"use strict";const h=require("electron"),O=require("path"),T=require("child_process"),z=require("tty"),G=require("util"),I=require("fs"),J=require("net");function Z(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var S={exports:{}},b={exports:{}},q={exports:{}},_,D;function H(){if(D)return _;D=1;var o=1e3,e=o*60,u=e*60,c=u*24,f=c*365.25;_=function(r,n){n=n||{};var s=typeof r;if(s==="string"&&r.length>0)return v(r);if(s==="number"&&isNaN(r)===!1)return n.long?m(r):g(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function v(r){if(r=String(r),!(r.length>100)){var n=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(r);if(n){var s=parseFloat(n[1]),d=(n[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return s*f;case"days":case"day":case"d":return s*c;case"hours":case"hour":case"hrs":case"hr":case"h":return s*u;case"minutes":case"minute":case"mins":case"min":case"m":return s*e;case"seconds":case"second":case"secs":case"sec":case"s":return s*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function g(r){return r>=c?Math.round(r/c)+"d":r>=u?Math.round(r/u)+"h":r>=e?Math.round(r/e)+"m":r>=o?Math.round(r/o)+"s":r+"ms"}function m(r){return a(r,c,"day")||a(r,u,"hour")||a(r,e,"minute")||a(r,o,"second")||r+" ms"}function a(r,n,s){if(!(r<n))return r<n*1.5?Math.floor(r/n)+" "+s:Math.ceil(r/n)+" "+s+"s"}return _}var M;function R(){return M||(M=1,function(o,e){e=o.exports=f.debug=f.default=f,e.coerce=a,e.disable=g,e.enable=v,e.enabled=m,e.humanize=H(),e.names=[],e.skips=[],e.formatters={};var u;function c(r){var n=0,s;for(s in r)n=(n<<5)-n+r.charCodeAt(s),n|=0;return e.colors[Math.abs(n)%e.colors.length]}function f(r){function n(){if(n.enabled){var s=n,d=+new Date,i=d-(u||d);s.diff=i,s.prev=u,s.curr=d,u=d;for(var t=new Array(arguments.length),p=0;p<t.length;p++)t[p]=arguments[p];t[0]=e.coerce(t[0]),typeof t[0]!="string"&&t.unshift("%O");var l=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(y,F){if(y==="%%")return y;l++;var A=e.formatters[F];if(typeof A=="function"){var L=t[l];y=A.call(s,L),t.splice(l,1),l--}return y}),e.formatArgs.call(s,t);var w=n.log||e.log||console.log.bind(console);w.apply(s,t)}}return n.namespace=r,n.enabled=e.enabled(r),n.useColors=e.useColors(),n.color=c(r),typeof e.init=="function"&&e.init(n),n}function v(r){e.save(r),e.names=[],e.skips=[];for(var n=(typeof r=="string"?r:"").split(/[\s,]+/),s=n.length,d=0;d<s;d++)n[d]&&(r=n[d].replace(/\*/g,".*?"),r[0]==="-"?e.skips.push(new RegExp("^"+r.substr(1)+"$")):e.names.push(new RegExp("^"+r+"$")))}function g(){e.enable("")}function m(r){var n,s;for(n=0,s=e.skips.length;n<s;n++)if(e.skips[n].test(r))return!1;for(n=0,s=e.names.length;n<s;n++)if(e.names[n].test(r))return!0;return!1}function a(r){return r instanceof Error?r.stack||r.message:r}}(q,q.exports)),q.exports}var j;function V(){return j||(j=1,function(o,e){e=o.exports=R(),e.log=f,e.formatArgs=c,e.save=v,e.load=g,e.useColors=u,e.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:m(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function u(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}e.formatters.j=function(a){try{return JSON.stringify(a)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}};function c(a){var r=this.useColors;if(a[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+a[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),!!r){var n="color: "+this.color;a.splice(1,0,n,"color: inherit");var s=0,d=0;a[0].replace(/%[a-zA-Z%]/g,function(i){i!=="%%"&&(s++,i==="%c"&&(d=s))}),a.splice(d,0,n)}}function f(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function v(a){try{a==null?e.storage.removeItem("debug"):e.storage.debug=a}catch{}}function g(){var a;try{a=e.storage.debug}catch{}return!a&&typeof process<"u"&&"env"in process&&(a=process.env.DEBUG),a}e.enable(g());function m(){try{return window.localStorage}catch{}}}(b,b.exports)),b.exports}var C={exports:{}},U;function Y(){return U||(U=1,function(o,e){var u=z,c=G;e=o.exports=R(),e.init=d,e.log=a,e.formatArgs=m,e.save=r,e.load=n,e.useColors=g,e.colors=[6,2,3,4,5,1],e.inspectOpts=Object.keys(process.env).filter(function(i){return/^debug_/i.test(i)}).reduce(function(i,t){var p=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(w,y){return y.toUpperCase()}),l=process.env[t];return/^(yes|on|true|enabled)$/i.test(l)?l=!0:/^(no|off|false|disabled)$/i.test(l)?l=!1:l==="null"?l=null:l=Number(l),i[p]=l,i},{});var f=parseInt(process.env.DEBUG_FD,10)||2;f!==1&&f!==2&&c.deprecate(function(){},"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var v=f===1?process.stdout:f===2?process.stderr:s(f);function g(){return"colors"in e.inspectOpts?!!e.inspectOpts.colors:u.isatty(f)}e.formatters.o=function(i){return this.inspectOpts.colors=this.useColors,c.inspect(i,this.inspectOpts).split(`
`).map(function(t){return t.trim()}).join(" ")},e.formatters.O=function(i){return this.inspectOpts.colors=this.useColors,c.inspect(i,this.inspectOpts)};function m(i){var t=this.namespace,p=this.useColors;if(p){var l=this.color,w="  \x1B[3"+l+";1m"+t+" \x1B[0m";i[0]=w+i[0].split(`
`).join(`
`+w),i.push("\x1B[3"+l+"m+"+e.humanize(this.diff)+"\x1B[0m")}else i[0]=new Date().toUTCString()+" "+t+" "+i[0]}function a(){return v.write(c.format.apply(c,arguments)+`
`)}function r(i){i==null?delete process.env.DEBUG:process.env.DEBUG=i}function n(){return process.env.DEBUG}function s(i){var t,p=process.binding("tty_wrap");switch(p.guessHandleType(i)){case"TTY":t=new u.WriteStream(i),t._type="tty",t._handle&&t._handle.unref&&t._handle.unref();break;case"FILE":var l=I;t=new l.SyncWriteStream(i,{autoClose:!1}),t._type="fs";break;case"PIPE":case"TCP":var w=J;t=new w.Socket({fd:i,readable:!1,writable:!0}),t.readable=!1,t.read=null,t._type="pipe",t._handle&&t._handle.unref&&t._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return t.fd=i,t._isStdio=!0,t}function d(i){i.inspectOpts={};for(var t=Object.keys(e.inspectOpts),p=0;p<t.length;p++)i.inspectOpts[t[p]]=e.inspectOpts[t[p]]}e.enable(n())}(C,C.exports)),C.exports}typeof process<"u"&&process.type==="renderer"?S.exports=V():S.exports=Y();var K=S.exports,k=O,Q=T.spawn,W=K("electron-squirrel-startup"),$=h.app,B=function(o,e){var u=k.resolve(k.dirname(process.execPath),"..","Update.exe");W("Spawning `%s` with args `%s`",u,o),Q(u,o,{detached:!0}).on("close",e)},X=function(){if(process.platform==="win32"){var o=process.argv[1];W("processing squirrel command `%s`",o);var e=k.basename(process.execPath);if(o==="--squirrel-install"||o==="--squirrel-updated")return B(["--createShortcut="+e],$.quit),!0;if(o==="--squirrel-uninstall")return B(["--removeShortcut="+e],$.quit),!0;if(o==="--squirrel-obsolete")return $.quit(),!0}return!1},x=X();const ee=Z(x),E={list(){return[]},async connect(o){return!0},async disconnect(){return!0},onAttach(o){},onDetach(o){}},P={get(o,e,u){return new Promise((c,f)=>{c({pid:o,tid:e,vid:u,value:0})})},set(o,e,u,c){return new Promise((f,v)=>{f({pid:o,tid:e,vid:u,value:c})})},onValueReceived(o){}};ee&&h.app.quit();const N=()=>{const o=new h.BrowserWindow({width:1100,height:912,icon:O.join(__dirname,"../renderer/main_window/assets/favicon.png"),webPreferences:{preload:O.join(__dirname,"preload.js")}});return o.loadURL("http://localhost:5173"),o.webContents.openDevTools(),o};h.app.whenReady().then(()=>{h.ipcMain.handle("nanodevices:list",E.list),h.ipcMain.handle("nanodevices:connect",E.connect),h.ipcMain.handle("nanodevices:disconnect",E.disconnect),h.ipcMain.handle("nano:get",P.get),h.ipcMain.handle("nano:set",P.set),N()});h.app.on("window-all-closed",()=>{process.platform!=="darwin"&&h.app.quit()});h.app.on("activate",()=>{h.BrowserWindow.getAllWindows().length===0&&N()});
